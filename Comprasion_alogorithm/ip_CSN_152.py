# reference from paper: Video Classification with Channel-Separated Convolutional Networks
#code from https://github.com/mnmjh1215/CSN-PyTorch
import torch
import torch.nn as nn  
from torchinfo import summary  
class CSNBottleneck(nn.Module):
    expansion = 4
    
    def __init__(self, in_channels, channels, stride=1, mode='ip'):
        super().__init__()
        
        assert mode in ['ip', 'ir']
        self.mode = mode
        
        self.conv1 = nn.Conv3d(in_channels, channels, kernel_size=1, bias=False)
        self.bn1 = nn.BatchNorm3d(channels)
        self.relu = nn.ReLU(inplace=True)
        
        conv2 = []
        if self.mode == 'ip':
            conv2.append(nn.Conv3d(channels, channels, kernel_size=1, stride=1, bias=False))
        conv2.append(nn.Conv3d(channels, channels, kernel_size=3, stride=stride, padding=1, bias=False, groups=channels))
        self.conv2 = nn.Sequential(*conv2)
        self.bn2 = nn.BatchNorm3d(channels)
        
        self.conv3 = nn.Conv3d(channels, channels * self.expansion, kernel_size=1, bias=False)
        self.bn3 = nn.BatchNorm3d(channels * self.expansion)
        
        self.downsample = nn.Sequential()
        if stride != 1 or in_channels != channels * self.expansion:
            self.downsample = nn.Sequential(
                nn.Conv3d(in_channels, channels * self.expansion, kernel_size=1, stride=stride, bias=False),
                nn.BatchNorm3d(channels * self.expansion)
            )
        
    def forward(self, x):
        shortcut = self.downsample(x)

        out = self.conv1(x)
        out = self.bn1(out)
        out = self.relu(out)
        
        out = self.conv2(out)
        out = self.bn2(out)
        out = self.relu(out)
        
        out = self.conv3(out)
        out = self.bn3(out)
            
        out += shortcut
        out = self.relu(out)
        
        return out


class CSN(nn.Module):
    def __init__(self, block, layers, num_classes, mode='ip'):
        super().__init__()
        
        assert mode in ['ip', 'ir']
        self.mode = mode
        
        self.in_channels = 64
        self.conv1 = nn.Conv3d(3, 64, kernel_size=(3, 7, 7), stride=(1, 2, 2), padding=(1, 3, 3), bias=False)
        self.bn1 = nn.BatchNorm3d(64)
        self.relu = nn.ReLU(inplace=True)
        self.max_pool = nn.MaxPool3d(kernel_size=(1, 3, 3), stride=(1, 2, 2), padding=(0, 1, 1))
        
        self.layer1 = self._make_layer(block, 64, layers[0], stride=1)
        self.layer2 = self._make_layer(block, 128, layers[1], stride=2)
        self.layer3 = self._make_layer(block, 256, layers[2], stride=2)
        self.layer4 = self._make_layer(block, 512, layers[3], stride=2)
        
        self.avg_pool = nn.AdaptiveAvgPool3d(1)
        self.fc = nn.Linear(512 * block.expansion, num_classes)
        
        # initialize
        for m in self.modules():
            if isinstance(m, nn.Conv3d):
                nn.init.kaiming_normal_(m.weight, mode='fan_out', nonlinearity='relu')
            elif isinstance(m, nn.BatchNorm3d):
                m.weight.data.fill_(1)
                m.bias.data.zero_()
                
    def _make_layer(self, block, channels, n_blocks, stride=1):
        assert n_blocks > 0, "number of blocks should be greater than zero"
        layers = []
        layers.append(block(self.in_channels, channels, stride, mode=self.mode))
        self.in_channels = channels * block.expansion
        for i in range(1, n_blocks):
            layers.append(block(self.in_channels, channels, mode=self.mode))
        
        return nn.Sequential(*layers)
    
    def forward(self, x):
        
        out = self.conv1(x)
        out = self.bn1(out)
        out = self.relu(out)
        out = self.max_pool(out)
        
        out = self.layer1(out)
        out = self.layer2(out)
        out = self.layer3(out)
        out = self.layer4(out)
        
        out = self.avg_pool(out)
        out = out.view(out.size(0), -1)
        out = self.fc(out)
        
        return out


def csn26(num_classes, mode='ip'):
    return CSN(CSNBottleneck, [1,2,4,1], num_classes=num_classes, mode=mode)


def csn50(num_classes, mode='ip'):
    return CSN(CSNBottleneck, [3,4,6,3], num_classes=num_classes, mode=mode)


def csn101(num_classes, mode='ip'):
    return CSN(CSNBottleneck, [3,4,23,3], num_classes=num_classes, mode=mode)


def csn152(num_classes):
    return CSN(CSNBottleneck, [3,8,36,3], num_classes=num_classes)


#shape of csn152
# ==========================================================================================
# Layer (type:depth-idx)                   Output Shape              Param #
# ==========================================================================================
# CSN                                      [1, 12]                   --
# ├─Conv3d: 1-1                            [1, 64, 32, 112, 112]     28,224
# ├─BatchNorm3d: 1-2                       [1, 64, 32, 112, 112]     128
# ├─ReLU: 1-3                              [1, 64, 32, 112, 112]     --
# ├─MaxPool3d: 1-4                         [1, 64, 32, 56, 56]       --
# ├─Sequential: 1-5                        [1, 256, 32, 56, 56]      --
# │    └─CSNBottleneck: 2-1                [1, 256, 32, 56, 56]      --
# │    │    └─Sequential: 3-1              [1, 256, 32, 56, 56]      16,896
# │    │    └─Conv3d: 3-2                  [1, 64, 32, 56, 56]       4,096
# │    │    └─BatchNorm3d: 3-3             [1, 64, 32, 56, 56]       128
# │    │    └─ReLU: 3-4                    [1, 64, 32, 56, 56]       --
# │    │    └─Sequential: 3-5              [1, 64, 32, 56, 56]       5,824
# │    │    └─BatchNorm3d: 3-6             [1, 64, 32, 56, 56]       128
# │    │    └─ReLU: 3-7                    [1, 64, 32, 56, 56]       --
# │    │    └─Conv3d: 3-8                  [1, 256, 32, 56, 56]      16,384
# │    │    └─BatchNorm3d: 3-9             [1, 256, 32, 56, 56]      512
# │    │    └─ReLU: 3-10                   [1, 256, 32, 56, 56]      --
# │    └─CSNBottleneck: 2-2                [1, 256, 32, 56, 56]      --
# │    │    └─Sequential: 3-11             [1, 256, 32, 56, 56]      --
# │    │    └─Conv3d: 3-12                 [1, 64, 32, 56, 56]       16,384
# │    │    └─BatchNorm3d: 3-13            [1, 64, 32, 56, 56]       128
# │    │    └─ReLU: 3-14                   [1, 64, 32, 56, 56]       --
# │    │    └─Sequential: 3-15             [1, 64, 32, 56, 56]       5,824
# │    │    └─BatchNorm3d: 3-16            [1, 64, 32, 56, 56]       128
# │    │    └─ReLU: 3-17                   [1, 64, 32, 56, 56]       --
# │    │    └─Conv3d: 3-18                 [1, 256, 32, 56, 56]      16,384
# │    │    └─BatchNorm3d: 3-19            [1, 256, 32, 56, 56]      512
# │    │    └─ReLU: 3-20                   [1, 256, 32, 56, 56]      --
# │    └─CSNBottleneck: 2-3                [1, 256, 32, 56, 56]      --
# │    │    └─Sequential: 3-21             [1, 256, 32, 56, 56]      --
# │    │    └─Conv3d: 3-22                 [1, 64, 32, 56, 56]       16,384
# │    │    └─BatchNorm3d: 3-23            [1, 64, 32, 56, 56]       128
# │    │    └─ReLU: 3-24                   [1, 64, 32, 56, 56]       --
# │    │    └─Sequential: 3-25             [1, 64, 32, 56, 56]       5,824
# │    │    └─BatchNorm3d: 3-26            [1, 64, 32, 56, 56]       128
# │    │    └─ReLU: 3-27                   [1, 64, 32, 56, 56]       --
# │    │    └─Conv3d: 3-28                 [1, 256, 32, 56, 56]      16,384
# │    │    └─BatchNorm3d: 3-29            [1, 256, 32, 56, 56]      512
# │    │    └─ReLU: 3-30                   [1, 256, 32, 56, 56]      --
# ├─Sequential: 1-6                        [1, 512, 16, 28, 28]      --
# │    └─CSNBottleneck: 2-4                [1, 512, 16, 28, 28]      --
# │    │    └─Sequential: 3-31             [1, 512, 16, 28, 28]      132,096
# │    │    └─Conv3d: 3-32                 [1, 128, 32, 56, 56]      32,768
# │    │    └─BatchNorm3d: 3-33            [1, 128, 32, 56, 56]      256
# │    │    └─ReLU: 3-34                   [1, 128, 32, 56, 56]      --
# │    │    └─Sequential: 3-35             [1, 128, 16, 28, 28]      19,840
# │    │    └─BatchNorm3d: 3-36            [1, 128, 16, 28, 28]      256
# │    │    └─ReLU: 3-37                   [1, 128, 16, 28, 28]      --
# │    │    └─Conv3d: 3-38                 [1, 512, 16, 28, 28]      65,536
# │    │    └─BatchNorm3d: 3-39            [1, 512, 16, 28, 28]      1,024
# │    │    └─ReLU: 3-40                   [1, 512, 16, 28, 28]      --
# │    └─CSNBottleneck: 2-5                [1, 512, 16, 28, 28]      --
# │    │    └─Sequential: 3-41             [1, 512, 16, 28, 28]      --
# │    │    └─Conv3d: 3-42                 [1, 128, 16, 28, 28]      65,536
# │    │    └─BatchNorm3d: 3-43            [1, 128, 16, 28, 28]      256
# │    │    └─ReLU: 3-44                   [1, 128, 16, 28, 28]      --
# │    │    └─Sequential: 3-45             [1, 128, 16, 28, 28]      19,840
# │    │    └─BatchNorm3d: 3-46            [1, 128, 16, 28, 28]      256
# │    │    └─ReLU: 3-47                   [1, 128, 16, 28, 28]      --
# │    │    └─Conv3d: 3-48                 [1, 512, 16, 28, 28]      65,536
# │    │    └─BatchNorm3d: 3-49            [1, 512, 16, 28, 28]      1,024
# │    │    └─ReLU: 3-50                   [1, 512, 16, 28, 28]      --
# │    └─CSNBottleneck: 2-6                [1, 512, 16, 28, 28]      --
# │    │    └─Sequential: 3-51             [1, 512, 16, 28, 28]      --
# │    │    └─Conv3d: 3-52                 [1, 128, 16, 28, 28]      65,536
# │    │    └─BatchNorm3d: 3-53            [1, 128, 16, 28, 28]      256
# │    │    └─ReLU: 3-54                   [1, 128, 16, 28, 28]      --
# │    │    └─Sequential: 3-55             [1, 128, 16, 28, 28]      19,840
# │    │    └─BatchNorm3d: 3-56            [1, 128, 16, 28, 28]      256
# │    │    └─ReLU: 3-57                   [1, 128, 16, 28, 28]      --
# │    │    └─Conv3d: 3-58                 [1, 512, 16, 28, 28]      65,536
# │    │    └─BatchNorm3d: 3-59            [1, 512, 16, 28, 28]      1,024
# │    │    └─ReLU: 3-60                   [1, 512, 16, 28, 28]      --
# │    └─CSNBottleneck: 2-7                [1, 512, 16, 28, 28]      --
# │    │    └─Sequential: 3-61             [1, 512, 16, 28, 28]      --
# │    │    └─Conv3d: 3-62                 [1, 128, 16, 28, 28]      65,536
# │    │    └─BatchNorm3d: 3-63            [1, 128, 16, 28, 28]      256
# │    │    └─ReLU: 3-64                   [1, 128, 16, 28, 28]      --
# │    │    └─Sequential: 3-65             [1, 128, 16, 28, 28]      19,840
# │    │    └─BatchNorm3d: 3-66            [1, 128, 16, 28, 28]      256
# │    │    └─ReLU: 3-67                   [1, 128, 16, 28, 28]      --
# │    │    └─Conv3d: 3-68                 [1, 512, 16, 28, 28]      65,536
# │    │    └─BatchNorm3d: 3-69            [1, 512, 16, 28, 28]      1,024
# │    │    └─ReLU: 3-70                   [1, 512, 16, 28, 28]      --
# │    └─CSNBottleneck: 2-8                [1, 512, 16, 28, 28]      --
# │    │    └─Sequential: 3-71             [1, 512, 16, 28, 28]      --
# │    │    └─Conv3d: 3-72                 [1, 128, 16, 28, 28]      65,536
# │    │    └─BatchNorm3d: 3-73            [1, 128, 16, 28, 28]      256
# │    │    └─ReLU: 3-74                   [1, 128, 16, 28, 28]      --
# │    │    └─Sequential: 3-75             [1, 128, 16, 28, 28]      19,840
# │    │    └─BatchNorm3d: 3-76            [1, 128, 16, 28, 28]      256
# │    │    └─ReLU: 3-77                   [1, 128, 16, 28, 28]      --
# │    │    └─Conv3d: 3-78                 [1, 512, 16, 28, 28]      65,536
# │    │    └─BatchNorm3d: 3-79            [1, 512, 16, 28, 28]      1,024
# │    │    └─ReLU: 3-80                   [1, 512, 16, 28, 28]      --
# │    └─CSNBottleneck: 2-9                [1, 512, 16, 28, 28]      --
# │    │    └─Sequential: 3-81             [1, 512, 16, 28, 28]      --
# │    │    └─Conv3d: 3-82                 [1, 128, 16, 28, 28]      65,536
# │    │    └─BatchNorm3d: 3-83            [1, 128, 16, 28, 28]      256
# │    │    └─ReLU: 3-84                   [1, 128, 16, 28, 28]      --
# │    │    └─Sequential: 3-85             [1, 128, 16, 28, 28]      19,840
# │    │    └─BatchNorm3d: 3-86            [1, 128, 16, 28, 28]      256
# │    │    └─ReLU: 3-87                   [1, 128, 16, 28, 28]      --
# │    │    └─Conv3d: 3-88                 [1, 512, 16, 28, 28]      65,536
# │    │    └─BatchNorm3d: 3-89            [1, 512, 16, 28, 28]      1,024
# │    │    └─ReLU: 3-90                   [1, 512, 16, 28, 28]      --
# │    └─CSNBottleneck: 2-10               [1, 512, 16, 28, 28]      --
# │    │    └─Sequential: 3-91             [1, 512, 16, 28, 28]      --
# │    │    └─Conv3d: 3-92                 [1, 128, 16, 28, 28]      65,536
# │    │    └─BatchNorm3d: 3-93            [1, 128, 16, 28, 28]      256
# │    │    └─ReLU: 3-94                   [1, 128, 16, 28, 28]      --
# │    │    └─Sequential: 3-95             [1, 128, 16, 28, 28]      19,840
# │    │    └─BatchNorm3d: 3-96            [1, 128, 16, 28, 28]      256
# │    │    └─ReLU: 3-97                   [1, 128, 16, 28, 28]      --
# │    │    └─Conv3d: 3-98                 [1, 512, 16, 28, 28]      65,536
# │    │    └─BatchNorm3d: 3-99            [1, 512, 16, 28, 28]      1,024
# │    │    └─ReLU: 3-100                  [1, 512, 16, 28, 28]      --
# │    └─CSNBottleneck: 2-11               [1, 512, 16, 28, 28]      --
# │    │    └─Sequential: 3-101            [1, 512, 16, 28, 28]      --
# │    │    └─Conv3d: 3-102                [1, 128, 16, 28, 28]      65,536
# │    │    └─BatchNorm3d: 3-103           [1, 128, 16, 28, 28]      256
# │    │    └─ReLU: 3-104                  [1, 128, 16, 28, 28]      --
# │    │    └─Sequential: 3-105            [1, 128, 16, 28, 28]      19,840
# │    │    └─BatchNorm3d: 3-106           [1, 128, 16, 28, 28]      256
# │    │    └─ReLU: 3-107                  [1, 128, 16, 28, 28]      --
# │    │    └─Conv3d: 3-108                [1, 512, 16, 28, 28]      65,536
# │    │    └─BatchNorm3d: 3-109           [1, 512, 16, 28, 28]      1,024
# │    │    └─ReLU: 3-110                  [1, 512, 16, 28, 28]      --
# ├─Sequential: 1-7                        [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-12               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-111            [1, 1024, 8, 14, 14]      526,336
# │    │    └─Conv3d: 3-112                [1, 256, 16, 28, 28]      131,072
# │    │    └─BatchNorm3d: 3-113           [1, 256, 16, 28, 28]      512
# │    │    └─ReLU: 3-114                  [1, 256, 16, 28, 28]      --
# │    │    └─Sequential: 3-115            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-116           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-117                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-118                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-119           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-120                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-13               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-121            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-122                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-123           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-124                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-125            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-126           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-127                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-128                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-129           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-130                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-14               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-131            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-132                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-133           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-134                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-135            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-136           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-137                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-138                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-139           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-140                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-15               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-141            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-142                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-143           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-144                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-145            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-146           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-147                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-148                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-149           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-150                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-16               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-151            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-152                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-153           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-154                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-155            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-156           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-157                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-158                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-159           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-160                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-17               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-161            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-162                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-163           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-164                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-165            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-166           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-167                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-168                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-169           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-170                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-18               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-171            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-172                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-173           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-174                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-175            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-176           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-177                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-178                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-179           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-180                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-19               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-181            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-182                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-183           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-184                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-185            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-186           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-187                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-188                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-189           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-190                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-20               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-191            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-192                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-193           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-194                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-195            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-196           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-197                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-198                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-199           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-200                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-21               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-201            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-202                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-203           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-204                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-205            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-206           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-207                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-208                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-209           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-210                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-22               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-211            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-212                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-213           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-214                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-215            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-216           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-217                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-218                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-219           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-220                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-23               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-221            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-222                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-223           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-224                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-225            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-226           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-227                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-228                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-229           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-230                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-24               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-231            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-232                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-233           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-234                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-235            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-236           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-237                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-238                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-239           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-240                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-25               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-241            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-242                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-243           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-244                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-245            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-246           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-247                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-248                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-249           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-250                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-26               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-251            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-252                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-253           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-254                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-255            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-256           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-257                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-258                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-259           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-260                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-27               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-261            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-262                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-263           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-264                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-265            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-266           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-267                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-268                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-269           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-270                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-28               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-271            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-272                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-273           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-274                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-275            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-276           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-277                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-278                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-279           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-280                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-29               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-281            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-282                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-283           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-284                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-285            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-286           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-287                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-288                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-289           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-290                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-30               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-291            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-292                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-293           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-294                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-295            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-296           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-297                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-298                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-299           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-300                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-31               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-301            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-302                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-303           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-304                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-305            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-306           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-307                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-308                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-309           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-310                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-32               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-311            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-312                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-313           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-314                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-315            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-316           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-317                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-318                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-319           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-320                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-33               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-321            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-322                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-323           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-324                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-325            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-326           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-327                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-328                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-329           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-330                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-34               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-331            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-332                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-333           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-334                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-335            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-336           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-337                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-338                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-339           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-340                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-35               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-341            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-342                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-343           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-344                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-345            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-346           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-347                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-348                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-349           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-350                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-36               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-351            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-352                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-353           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-354                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-355            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-356           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-357                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-358                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-359           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-360                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-37               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-361            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-362                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-363           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-364                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-365            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-366           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-367                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-368                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-369           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-370                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-38               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-371            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-372                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-373           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-374                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-375            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-376           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-377                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-378                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-379           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-380                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-39               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-381            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-382                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-383           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-384                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-385            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-386           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-387                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-388                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-389           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-390                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-40               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-391            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-392                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-393           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-394                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-395            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-396           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-397                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-398                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-399           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-400                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-41               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-401            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-402                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-403           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-404                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-405            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-406           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-407                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-408                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-409           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-410                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-42               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-411            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-412                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-413           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-414                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-415            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-416           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-417                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-418                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-419           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-420                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-43               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-421            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-422                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-423           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-424                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-425            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-426           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-427                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-428                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-429           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-430                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-44               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-431            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-432                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-433           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-434                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-435            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-436           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-437                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-438                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-439           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-440                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-45               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-441            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-442                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-443           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-444                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-445            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-446           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-447                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-448                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-449           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-450                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-46               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-451            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-452                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-453           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-454                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-455            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-456           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-457                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-458                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-459           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-460                  [1, 1024, 8, 14, 14]      --
# │    └─CSNBottleneck: 2-47               [1, 1024, 8, 14, 14]      --
# │    │    └─Sequential: 3-461            [1, 1024, 8, 14, 14]      --
# │    │    └─Conv3d: 3-462                [1, 256, 8, 14, 14]       262,144
# │    │    └─BatchNorm3d: 3-463           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-464                  [1, 256, 8, 14, 14]       --
# │    │    └─Sequential: 3-465            [1, 256, 8, 14, 14]       72,448
# │    │    └─BatchNorm3d: 3-466           [1, 256, 8, 14, 14]       512
# │    │    └─ReLU: 3-467                  [1, 256, 8, 14, 14]       --
# │    │    └─Conv3d: 3-468                [1, 1024, 8, 14, 14]      262,144
# │    │    └─BatchNorm3d: 3-469           [1, 1024, 8, 14, 14]      2,048
# │    │    └─ReLU: 3-470                  [1, 1024, 8, 14, 14]      --
# ├─Sequential: 1-8                        [1, 2048, 4, 7, 7]        --
# │    └─CSNBottleneck: 2-48               [1, 2048, 4, 7, 7]        --
# │    │    └─Sequential: 3-471            [1, 2048, 4, 7, 7]        2,101,248
# │    │    └─Conv3d: 3-472                [1, 512, 8, 14, 14]       524,288
# │    │    └─BatchNorm3d: 3-473           [1, 512, 8, 14, 14]       1,024
# │    │    └─ReLU: 3-474                  [1, 512, 8, 14, 14]       --
# │    │    └─Sequential: 3-475            [1, 512, 4, 7, 7]         275,968
# │    │    └─BatchNorm3d: 3-476           [1, 512, 4, 7, 7]         1,024
# │    │    └─ReLU: 3-477                  [1, 512, 4, 7, 7]         --
# │    │    └─Conv3d: 3-478                [1, 2048, 4, 7, 7]        1,048,576
# │    │    └─BatchNorm3d: 3-479           [1, 2048, 4, 7, 7]        4,096
# │    │    └─ReLU: 3-480                  [1, 2048, 4, 7, 7]        --
# │    └─CSNBottleneck: 2-49               [1, 2048, 4, 7, 7]        --
# │    │    └─Sequential: 3-481            [1, 2048, 4, 7, 7]        --
# │    │    └─Conv3d: 3-482                [1, 512, 4, 7, 7]         1,048,576
# │    │    └─BatchNorm3d: 3-483           [1, 512, 4, 7, 7]         1,024
# │    │    └─ReLU: 3-484                  [1, 512, 4, 7, 7]         --
# │    │    └─Sequential: 3-485            [1, 512, 4, 7, 7]         275,968
# │    │    └─BatchNorm3d: 3-486           [1, 512, 4, 7, 7]         1,024
# │    │    └─ReLU: 3-487                  [1, 512, 4, 7, 7]         --
# │    │    └─Conv3d: 3-488                [1, 2048, 4, 7, 7]        1,048,576
# │    │    └─BatchNorm3d: 3-489           [1, 2048, 4, 7, 7]        4,096
# │    │    └─ReLU: 3-490                  [1, 2048, 4, 7, 7]        --
# │    └─CSNBottleneck: 2-50               [1, 2048, 4, 7, 7]        --
# │    │    └─Sequential: 3-491            [1, 2048, 4, 7, 7]        --
# │    │    └─Conv3d: 3-492                [1, 512, 4, 7, 7]         1,048,576
# │    │    └─BatchNorm3d: 3-493           [1, 512, 4, 7, 7]         1,024
# │    │    └─ReLU: 3-494                  [1, 512, 4, 7, 7]         --
# │    │    └─Sequential: 3-495            [1, 512, 4, 7, 7]         275,968
# │    │    └─BatchNorm3d: 3-496           [1, 512, 4, 7, 7]         1,024
# │    │    └─ReLU: 3-497                  [1, 512, 4, 7, 7]         --
# │    │    └─Conv3d: 3-498                [1, 2048, 4, 7, 7]        1,048,576
# │    │    └─BatchNorm3d: 3-499           [1, 2048, 4, 7, 7]        4,096
# │    │    └─ReLU: 3-500                  [1, 2048, 4, 7, 7]        --
# ├─AdaptiveAvgPool3d: 1-9                 [1, 2048, 1, 1, 1]        --
# ├─Linear: 1-10                           [1, 12]                   24,588
# ==========================================================================================
# Total params: 32,197,644
# Trainable params: 32,197,644
# Non-trainable params: 0
# Total mult-adds (G): 83.29
# ==========================================================================================
# Input size (MB): 19.27
# Forward/backward pass size (MB): 6184.89
# Params size (MB): 128.79
# Estimated Total Size (MB): 6332.95
# ==========================================================================================
if __name__ == '__main__':
    cns152 = csn152(12)
    summary(model=cns152,input_size=(16,3,16,116,112))
    
    